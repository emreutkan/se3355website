<div class="home-container">
  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="loading-spinner"></div>
    <p>Loading amazing movies...</p>
  </div>

  <!-- Error State -->
  <div class="error-container" *ngIf="error">
    <h2>{{ error }}</h2>
    <button (click)="onRetry()" class="retry-btn">
      Try Again
    </button>
  </div>



  <!-- Main Content -->
  <div class="main-content" *ngIf="!isLoading && !error">

    <!-- Featured Movies Slider -->
    <section class="featured-section" *ngIf="featuredMovies.length > 0">
      <app-movie-slider
        [movies]="featuredMovies"
        [autoSlide]="true"
        [slideInterval]="6000">
      </app-movie-slider>
    </section>

    <!-- Fallback if no featured movies -->
    <section class="featured-fallback" *ngIf="!isLoading && !error && featuredMovies.length === 0">
      <div style="background: #1a1a1a; padding: 20px; border-radius: 8px; text-align: center; margin-bottom: 40px;">
        <h2>No Featured Movies Available</h2>
        <p>Featured content is currently unavailable. Check your API connection.</p>
      </div>
    </section>

    <!-- Popular Movies -->
    <section class="movie-section" *ngIf="popularMovies.length > 0">
      <div class="section-header">
        <h2 class="section-title">Popular Movies</h2>
        <a href="#" class="view-all-link">View All</a>
      </div>

      <div class="movies-grid">
        <app-movie-card
          *ngFor="let movie of getSlicedMovies(popularMovies, 12)"
          [movie]="movie">
        </app-movie-card>
      </div>
    </section>

    <!-- Top Rated Movies Slider -->
    <section class="top-rated-section" *ngIf="topRatedMovies.length > 0">
      <div class="section-header">
        <h2 class="section-title">Top Rated Movies</h2>
        <a href="#" class="view-all-link">View All</a>
      </div>

      <div class="top-rated-slider">
        <div class="slider-container">
          <button class="slider-btn prev-btn" (click)="scrollSlider('left')" [disabled]="!canScrollLeft"
                  title="Scroll left" aria-label="Scroll left">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
            </svg>
          </button>

          <div class="slider-track" #sliderTrack>
            <div class="top-rated-card" *ngFor="let movie of topRatedMovies; let i = index">
              <div class="movie-poster-container">
                <img [src]="movieService.getPosterUrl(movie.image_url)"
                     [alt]="movie.title"
                     [title]="movie.title"
                     class="movie-poster"
                     (click)="navigateToMovie(movie.id)">
                <div class="imdb-rating">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="#f5c518">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                  </svg>
                  <span class="rating-score">{{ movie.imdb_score.toFixed(1) }}</span>
                </div>
              </div>

              <div class="movie-info">
                <h3 class="movie-title" (click)="navigateToMovie(movie.id)">{{ movie.title }}</h3>
                <div class="movie-meta">
                  <span class="movie-year" *ngIf="movie.year">{{ movie.year }}</span>
                  <span class="movie-runtime" *ngIf="movie.runtime_min">{{ movieService.formatRuntime(movie.runtime_min) }}</span>
                </div>
              </div>

              <div class="movie-actions">
                <button class="trailer-btn" *ngIf="movie.trailer_url" (click)="openTrailer(movie.trailer_url)">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M8 5v14l11-7z"/>
                  </svg>
                  Trailer
                </button>
                <button class="trailer-btn disabled" *ngIf="!movie.trailer_url" disabled>
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M8 5v14l11-7z"/>
                  </svg>
                  No Trailer
                </button>
              </div>
            </div>
          </div>

          <button class="slider-btn next-btn" (click)="scrollSlider('right')" [disabled]="!canScrollRight"
                  title="Scroll right" aria-label="Scroll right">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path d="M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"/>
            </svg>
          </button>
        </div>
      </div>
    </section>



    <!-- Movie Stats/Rankings Section -->
    <section class="stats-section">
      <div class="section-header">
        <h2 class="section-title">Trending Now</h2>
      </div>

      <div class="stats-grid">
        <div class="stat-card popular-card">
          <h3>Most Popular</h3>
          <div class="stat-movie" *ngIf="popularMovies.length > 0">
            <img [src]="movieService.getPosterUrl(popularMovies[0].image_url)"
                 [alt]="popularMovies[0].title"
                 [title]="popularMovies[0].title"
                 class="stat-poster">
            <div class="stat-info">
              <h4>{{ popularMovies[0].title }}</h4>
              <div class="stat-rating">
                ⭐ {{ popularMovies[0].imdb_score.toFixed(1) }}
              </div>
            </div>
          </div>
        </div>

        <div class="stat-card rated-card">
          <h3>Top Rated</h3>
          <div class="stat-movie" *ngIf="topRatedMovies.length > 0">
            <img [src]="movieService.getPosterUrl(topRatedMovies[0].image_url)"
                 [alt]="topRatedMovies[0].title"
                 [title]="topRatedMovies[0].title"
                 class="stat-poster">
            <div class="stat-info">
              <h4>{{ topRatedMovies[0].title }}</h4>
              <div class="stat-rating">
                ⭐ {{ topRatedMovies[0].imdb_score.toFixed(1) }}
              </div>
            </div>
          </div>
        </div>

        <div class="stat-card recent-card">
          <h3>Recently Added</h3>
<!--          <div class="stat-movie" *ngIf="nowPlayingMovies.length > 0">-->
<!--            <img [src]="movieService.getPosterUrl(nowPlayingMovies[0].image_url)"-->
<!--                 [alt]="nowPlayingMovies[0].title"-->
<!--                 [title]="nowPlayingMovies[0].title"-->
<!--                 class="stat-poster">-->
<!--            <div class="stat-info">-->
<!--              <h4>{{ nowPlayingMovies[0].title }}</h4>-->
<!--              <div class="stat-rating">-->
<!--                ⭐ {{ nowPlayingMovies[0].imdb_score.toFixed(1) }}-->
<!--              </div>-->
<!--            </div>-->
<!--          </div>-->
        </div>
      </div>
    </section>

  </div>
</div>
